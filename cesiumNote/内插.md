# 内插

### DEM线性内插函数
$$Z=a_0+a_1X+a_2Y$$
$$\begin{bmatrix}a_0\\a_1\\a_2 \\\end{bmatrix}=\begin{bmatrix} 1 & x_1 & y_1 \\ 1 & x_2 & y_2 \\ 1 & x_3 & y_3\end{bmatrix}^{-1} \begin{bmatrix} z_1 \\ z_2 \\ z_3 \end{bmatrix} $$

### DEM双线性内插
使用最靠近插值点的四个已知数据点组成一个四边形

$$Z=f(x,y)=a_0+a_1x+a_2x+a_3xy$$
$$\begin{bmatrix}a_0\\a_1\\a_2 \\a_3 \end{bmatrix}=\begin{bmatrix} 1 & x_1 & y_1 & x_1y_1 \\ 1 & x_2 & y_2 & x_2y_2 \\ 1 & x_3 & y_3 & x_3y_3 \\ 1 & x_4 & y_4 &x_4y_4 \end{bmatrix}^{-1} \begin{bmatrix} z_1 \\ z_2 \\ z_3 \\ z_4 \end{bmatrix} $$

**双线性多项式曲面插值**<br>
$$Z_1=a_0+a_1 \ \ \ \ a_0=Z_4$$
$$Z_2=a_0+a_1+a_2+a_3\ \ \ \ a_1=Z_1-Z_4$$
$$Z_3=a_0+a_2\ \ \ \ a_2=Z_3-Z_4$$
$$Z_4=a_0\ \ \ \ a_3=Z_2+Z_4-Z_1-Z_3$$
$$Z_p=Z_4(1-\frac{x_p}{L})(1-\frac{y_p}{L})+Z_3(1-\frac{y_p}{L})(\frac{x_p}{L})+Z_2(\frac{x_p}{L})(\frac{y_p}{L})+Z_1(1-\frac{x_p}{L})(\frac{y_p}{L})$$

### DEM样条函数内插函数形式
eg:4\*4点阵

$z=f(x,y)=a_1x^3y^3+a_2x^2y^3+a_3xy^3+a_4y^3+a_5x^3y^2+a_6x^2y^2+a_7xy^2+a_8y^2+a_9x^3y+a_{10}x^2y+a_{11}xy+a_{12}y+a_{13}x^3+a_{14}x^2+a_{15}x+a_{16}$

### 多面函数内插
在每个数据点上建立一个曲面。然后在Z方向上将各个曲面按一定比例叠加成一张整体的连续曲面，使之严格地通过各个数据点。
$$z=f(x,y)=\sum_{i=1}^{n}K_iQ(x,y,x_i,y_i)$$

$Q(x,y,x_i,y_i)$为参加插值计算的简单数学面，又称多面函数的核函数。

为了计算方便，多层叠加面中的n个核函数一般选用同一类型的简单函数，通常是围绕竖向轴旋转的曲面，这条竖轴正好通过某一参考点：<br> 
锥面：$Q_1(x,y,x_i,y_i)=C+[(x-x_1)^2+(y-y_i)^2]^{\frac12}$<br> 
双曲面：$Q_2(x,y,x_i,y_i)=[(x-x_i)^2+(y-y_i)^2+6]^{\frac12}$<br> 
三次曲面：$Q_3(x,y,x_i,y_i)=C+[(x-x_i)^2+(y-y_i)^2]^{\frac32}$<br> 
旋转面：$Q_4(x,y,x_i,y_i)=1-D_i^2/a^2$

### DEM最小二乘拟合法
用一定的函数对空间现象的空间分布特征进行分析，用函数所代表的数学表面来逼近（或拟合）现象的实际表面。

根据一系列离散的已知数据点${x_i,y_i,z_i}$，采用按距离加权的最小二乘法，为局部内插拟合一个曲面。<br> 

z值的误差方程为：$v_i=f(x_i,y_i)-z_i$

在最小二乘的意义下：$$Q=\sum_{i=1}^{N}[f(x_i,y_i)-z_i]^2=\sum_{i=1}^{n}w_iv_i^2=[wvv]$$

